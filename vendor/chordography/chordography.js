function chartMaker(w,x){var B=function(d){d=d||{};var a=[],c={cellWidth:21,cellHeight:25,dotDia:19,nutHeight:5,fontBaseline:7,fontHeight:16,barGirth:3,barHeight:9,padding:4,minSpan:4,barre:!0},b,l,n,u,m,v,y,s,t,p,q,z,A,w=function(a){for(var c=(n-1)*p,g=b?0:1,f="";g<=u;g++)f+=" M"+o(s)+" "+o(t+g*q)+" h"+o(c);a.setAttributeNS(null,"d",f)},x=function(a){for(var c=u*q,g=0,b="";g<n;g++)b+=" M"+o(s+g*p)+" "+o(t)+" v"+o(c);a.setAttributeNS(null,"d",b)},B=function(a,k,g,f){for(var e=0,r=s;e<g.length;e++,
r+=p)if(0<g[e]){var h=document.createElementNS("http://www.w3.org/2000/svg","circle"),l=o(t+(g[e]-(b?m-.5:.5))*q);h.cx.baseVal.value=r;h.cy.baseVal.value=l;h.r.baseVal.value=c.dotDia/2;a.appendChild(h);f&&f[e]&&(h=document.createElementNS("http://www.w3.org/2000/svg","tspan"),h.setAttributeNS(null,"x",o(r)),k.appendChild(h),h.setAttributeNS(null,"y",o(l+q/2-c.fontBaseline)),h.appendChild(document.createTextNode(f[e])))}},D=function(a){var b;b=(n-1)*p;var g=o(c.nutHeight/2);b="M"+o(s)+" "+o(t)+" h -"+
g+" a"+g+" "+g+" 0 0 1 0 -"+2*g+" h"+o(b+2*g)+" a"+g+" "+g+" 0 0 1 0 "+2*g+" z";a.setAttributeNS(null,"d",b)},E=function(a){var k=s+p*l[0],g=t+q*(b?.5:m-.5),f=o(p*(l[l.length-1]-l[0])),e=c.dotDia/2,r=o(f/2+e/2),h=c.barHeight,d=h+c.barGirth,n="M"+o(k-e)+" "+o(g-e),n=n+(" A "+r+" "+o(h)+" 0 0 1 "+o(k+f+e)+" "+o(g-e)),n=n+(" A "+r+" "+o(d)+" 0 0 0 "+o(k-e)+" "+o(g-e));a.setAttributeNS(null,"d",n)},C=function(a,b,c,f){a.setAttributeNS(null,"x",c);a.setAttributeNS(null,"y",f);a.appendChild(document.createTextNode(b))};
addVector=function(a,b,g,f){f-=c.fontBaseline;for(var e=0;e<n;e++)if(b[e]){var r=document.createElementNS("http://www.w3.org/2000/svg","tspan");r.setAttributeNS(null,"x",o(g+e*p));r.setAttributeNS(null,"y",o(f));r.appendChild(document.createTextNode(b[e]));a.appendChild(r)}};o=function(a){return Number(a.toFixed(1))};createNodes=function(a,b){var c,f=[];for(c=0;c<b.length;c++)f[c]=document.createElementNS("http://www.w3.org/2000/svg",a),f[c].className.baseVal=b[c];return f};(function(){for(var a in d)void 0!==
c[a]&&(c[a]=d[a])})();return function(d,k){(function(a){var f,e,d=0,h;m=Number.MAX_VALUE;e=-m;a.head=[];for(f=0;f<a.fret.length;f++)h=a.fret[f],isNaN(h)||0>h?a.head[f]="x":(0==h?(a.head[f]="o",l=[]):(a.head[f]="",d++,h<m?(m=h,l=[],l.push(f)):h==m&&0<l.length&&l.push(f)),h>e&&(e=h));m>e&&(m=1,e=c.minSpan);4>d&&(l=[]);u=Math.max(c.minSpan,e-m+1);b=1<m&&e>u;n=a.fret.length})(k);p=c.cellWidth;s=c.padding+p/2+(b?p:0);q=c.cellHeight;A=c.padding+q*(k.title?1:0);z=A+q;t=z+c.nutHeight*(b?0:1);v=o(s+p*(n-.5)+
c.padding);y=o(t+q*u+(k.footer?q:0)+c.padding);d.setAttribute("xmlns","http://www.w3.org/2000/svg");d.setAttribute("width",o(v*(k.scale||1)));d.setAttribute("height",o(y*(k.scale||1)));d.setAttribute("viewBox","0 0 "+v+" "+y);d.setAttribute("preserveAspectRatio","xMidYMid meet");for(d.setAttribute("font-size",c.fontHeight);0<d.childNodes.length;)d.removeChild(d.lastChild);(function(c){var b,e,d;for(b in c)for(e=c[b].split(","),d=0;d<e.length;d++)a[e[d]]=document.createElementNS("http://www.w3.org/2000/svg",
b),a[e[d]].className.baseVal=e[d]})({g:"grid,dots,text",path:"frets,strings,nut,barre",text:"title,header,labels,lofret,footer"});d.appendChild(a.grid);d.appendChild(a.dots);B(a.dots,a.labels,k.fret,k.label);d.appendChild(a.text);a.text.setAttributeNS(null,"text-anchor","middle");a.grid.appendChild(a.frets);w(a.frets);a.grid.appendChild(a.strings);x(a.strings);b?(a.text.appendChild(a.lofret),C(a.lofret,m,c.padding+p/2,t+q-c.fontBaseline)):(a.grid.appendChild(a.nut),D(a.nut));k.title&&(a.text.appendChild(a.title),
C(a.title,k.title,o(v/2),o(A)));a.text.appendChild(a.header);addVector(a.header,k.head,s,z);k.label&&a.text.appendChild(a.labels);k.footer&&(a.text.appendChild(a.footer),addVector(a.footer,k.footer,s,t+q*(u+1)));c.barre&&1<l.length&&1<=m&&(d.appendChild(a.barre),E(a.barre))}}(function(d,a){d=d||16;a=a||1.2;var c=function(a){return Number(a.toFixed(1))},b={fontHeight:d,dotDia:c(1.2*d)};1>a?(b.cellHeight=c(1.2*b.dotDia),b.padding=c(.2*b.cellHeight),b.cellWidth=c(b.cellHeight/a)):(b.cellWidth=c(1.2*
b.dotDia),b.padding=c(.2*b.cellWidth),b.cellHeight=c(b.cellWidth*a));b.fontBaseline=c((b.cellHeight-.7*b.fontHeight)/2);b.nutHeight=c(.2*b.cellHeight);b.barHeight=c(.35*b.cellHeight);b.barGirth=c(.1*b.cellHeight);return b}(w,x));return function(d,a){var c={},b;for(b in a)c[b]=a[b];if(a.fret)for(c.fret=a.fret.split(","),b=0;b<c.fret.length;b++)c.fret[b]=parseInt(c.fret[b],10);a.label&&(c.label=a.label.split(","));a.footer&&(c.footer=a.footer.split(","));B(d,c)}};
//http://chordography.blogspot.co.uk/p/dynamic-charts.html
